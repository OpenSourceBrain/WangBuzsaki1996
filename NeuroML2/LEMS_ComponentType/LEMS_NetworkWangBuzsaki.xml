<?xml version='1.0' encoding='UTF-8'?>
<Lems>

<!-- Wang-Buzsaki basket cell with classical HH Sodium, Potassium and leak conductance + current clamp to make it spike -->

    <Target component="sim1"/>

    <Include file="Cells.xml"/>
    <Include file="Synapses.xml"/>
    <Include file="Networks.xml"/>
    <Include file="Simulation.xml"/>

    <Include file="WangBuzsakiCell.xml"/>
    <Include file="WangBuzsakiSynapse.xml"/>

    <wangBuzsakiBasketCell id="wb1" spikeThresh="0mV" r="2.82095um" C="1pF" v0="-70mV" gL="0.1mS_per_cm2" eL="-65mV" gNa="35mS_per_cm2" eNa="55mV" alpham_rate="1per_ms" alpham_midpoint="-35mV" alpham_scale="10mV"  betam_rate="4per_ms" betam_midpoint="-60mV" betam_scale="-18mV" h_q="5" alphah_rate="0.07per_ms" alphah_midpoint="-58mV" alphah_scale="-20mV" betah_rate="1per_ms" betah_midpoint="-28mV" betah_scale="-10mV"  gK="9mS_per_cm2" eK="-90mV" n_q="5" alphan_rate="1per_ms" alphan_midpoint="-34mV" alphan_scale1="100mV"  alphan_scale2="10mV" betan_rate="0.125per_ms" betan_midpoint="-44mV" betan_scale="-80mV"/> 
    
    <wangBuzsakiSynapse id="wbs1" g_s="1nS" E_s="-75mV" Vth="0mV" Vscale="-2mV" alpha="0.012per_s" beta="0.0001per_s"/>
    <!--Dummy synapse which emits no current. Used as presynaptic endpoint for analog synaptic connection.-->
    <silentSynapse id="silent"/>    
        
        
    <!-- The surface of the cell is 100um2 (2pA: 2uA/cm2 input...)-->
    <pulseGenerator id="IClamp" delay="0ms" duration="100ms" amplitude="2pA"/>

    <network id="net1" type="networkWithTemperature" temperature = "37 degC">
        <population id="pop1" component="wb1" type="populationList" size="1">
            <instance id="0">
                <location x="0" y="0" z="0"/>
            </instance>
        </population>
        <population id="pop2" component="wb1" type="populationList" size="1">
            <instance id="0">
                <location x="0" y="0" z="10"/>
            </instance>
        </population>
        
        <continuousProjection id ="WBsynapse" presynapticPopulation="pop1" postsynapticPopulation="pop2">
            <continuousConnectionInstance id="0" preCell="../pop1/0/wb1" postCell="../pop2/0/wb1" preComponent="silent" postComponent="wbs1"/>
        </continuousProjection>       

        <inputList id="IClamp" component="IClamp" population="pop">
            <input id="0" target="../pop1/0/wb1" destination="synapses"/>
        </inputList>

    </network>

<!-- End of NeuroML2 content -->
        
<!-- Simulation specifications -->

    <Simulation id="sim1" length="100ms" step="0.001ms" target="net1">

        <Display id="d1" title="WangBuzsaki PV+BC with 2uA/cm2 input" timeScale="1ms" xmin="-10" xmax="110" ymin="-80" ymax="40">
            <Line id="PV+BC V" quantity="pop1/0/wb1/v" scale="1mV" color="#0000ff" timeScale="1ms"/>
        </Display>
        
        <Display id="d2" title="WangBuzsaki PV+BC with synaptic inpt" timeScale="1ms" xmin="-10" xmax="110" ymin="-80" ymax="40">
            <Line id="PV+BC V" quantity="pop2/0/wb1/v" scale="1mV" color="#0000ff" timeScale="1ms"/>
        </Display>
        
        
        <Display id="d3" title="..." timeScale="1ms" xmin="-20"  xmax="320" ymin="-0.1" ymax="1.1">
            <Line id="s" quantity="pop2/0/wb1/wbs1/s" scale="1" color="#FF0000" timeScale="1ms" />
        </Display>
    
        <!--
        <OutputFile id="of0" fileName="wangbuzsaki.dat">
            <OutputColumn id="bc" quantity="pop/0/wb1/v"/>
        </OutputFile>
        -->
      
    </Simulation>
  
</Lems>
